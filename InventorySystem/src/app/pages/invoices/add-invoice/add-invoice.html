<div class="container my-4">
  <div class="card shadow-sm border-0 rounded">
    <div class="card-body">
      <h2 class="card-title mb-4 fw-bold">Add Invoice</h2>

      <form (ngSubmit)="onSubmit()" class="needs-validation" novalidate>
        <!-- Customer Name -->
        <div class="mb-3">
          <label class="form-label fw-semibold">Customer Name:</label>
          <input 
            type="text" 
            class="form-control" 
            [(ngModel)]="invoice.customerName" 
            name="customerName" 
            required 
          />
        </div>

        <!-- Invoice Items -->
        <h4 class="mt-4 mb-3 fw-bold">Invoice Items</h4>
        <div class="table-responsive shadow-sm rounded">
          <table class="table table-striped table-bordered align-middle mb-0">
            <thead class="table-dark">
              <tr>
                <th>Item</th>
                <th>Price</th>
                <th>Qty</th>
                <th>Total</th>
                <th class="text-center">Action</th>
              </tr>
            </thead>
            <tbody>
              <tr *ngFor="let row of invoice.invoiceItems; let i = index">
                <td>
                  <select 
                    class="form-select" 
                    [(ngModel)]="row.itemId" 
                    name="item-{{i}}" 
                    (change)="onItemChange(i)"
                  >
                    <option [ngValue]="null">-- Select --</option>
                    <option *ngFor="let item of items" [ngValue]="item.itemId">
                      {{ item.name }}
                    </option>
                  </select>
                </td>
                <td>LKR. {{ row.price }}.00</td>
                <td>
                  <input 
                    type="number" 
                    class="form-control" 
                    [(ngModel)]="row.quantity" 
                    name="qty-{{i}}" 
                    (input)="updateLineTotal(i)" 
                    min="1" 
                  />
                </td>
                <td>LKR. {{ row.total }}.00</td>
                <td class="text-center">
                  <button 
                    type="button" 
                    class="btn btn-sm btn-danger shadow-sm"
                    (click)="removeRow(i)"
                  >
                    <i class="bi bi-trash"></i> Remove
                  </button>
                </td>
              </tr>
            </tbody>
          </table>
        </div>

        <!-- Add Item -->
        <div class="mb-3 mt-3">
          <button type="button" class="btn btn-outline-primary shadow-sm" (click)="addRow()">
            <i class="bi bi-plus-circle"></i> Add Item
          </button>
        </div>

        <!-- Grand Total -->
        <div class="d-flex justify-content-between align-items-center border-top pt-3 mt-3">
          <h5 class="mb-0 fw-bold">Grand Total:</h5>
          <h5 class="mb-0 text-success">LKR. {{ invoice.grandTotal }}.00</h5>
        </div>

        <!-- Save Invoice -->
        <div class="mt-4">
          <button type="submit" class="btn btn-success shadow-sm">
            <i class="bi bi-save"></i> Save Invoice
          </button>
        </div>
      </form>
    </div>
  </div>
</div>
